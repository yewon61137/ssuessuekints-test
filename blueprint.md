# Blueprint: 뜨개질 도안 생성기 (Knitting Pattern Generator)

## 1. 개요 (Overview)
사용자가 이미지를 업로드하고 원하는 편물의 크기(cm) 및 실 굵기를 선택하면, 표준 게이지를 바탕으로 자동으로 코/단 수를 계산하고 이미지를 배치하여 뜨개질 도안으로 변환해주는 웹 애플리케이션입니다.

## 2. 주요 기능 (Features)
*   **이미지 업로드**: JPG, PNG 지원.
*   **직관적인 설정 (실 굵기 및 cm 기반)**:
    *   **실 굵기 (Yarn Weight)**: Fingering, DK, Aran/Worsted, Chunky, Super Bulky 등 선택. (선택 시 내부적으로 평균 게이지 적용)
    *   **원하는 편물 크기 (cm)**: 가로(Width), 세로(Height) cm 입력.
    *   **사용할 최대 색상 수**: 제한할 색상 수 입력.
*   **도안 자동 생성 및 비율 유지 (Letterboxing)**:
    *   입력된 cm와 실 굵기 게이지를 바탕으로 도안의 총 가로 코 수와 세로 단 수를 계산합니다.
    *   원본 이미지의 비율이 깨지지 않도록, 계산된 도안 크기 안에서 이미지를 가운데에 맞추고(Fit) 남는 공간은 배경색(기본 흰색)으로 처리합니다.
*   **개선된 색상 양자화 (Color Quantization)**:
    *   그림자(명암 차이)보다는 고유한 색상(Hue, 채도 높은 색)을 보존하도록 색상 추출 알고리즘(K-means++)을 개선하여 뚜렷한 색상이 뭉개지는 현상을 방지합니다.
*   **시각적 편의성**:
    *   10코, 10단마다 굵은 선으로 그리드(Grid) 표시.
    *   사용된 색상 팔레트를 번호와 함께 화면 측면에 나열.
*   **PDF 저장**: 생성된 도안 이미지와 색상표를 PDF 파일로 다운로드.

## 3. 개발 계획 (Action Plan)
1.  **UI 업데이트**:
    *   코 수 입력 대신 '실 굵기 드롭다운', '가로 cm', '세로 cm' 입력창으로 변경.
2.  **코어 로직 수정 (크기 및 배치)**:
    *   `실 굵기 -> 게이지 매핑표` 작성.
    *   총 코 수 = (가로cm / 10) * 가로 게이지 코 수
    *   총 단 수 = (세로cm / 10) * 세로 게이지 단 수
    *   계산된 크기의 캔버스를 만들고, 비율을 유지하며 중앙에 원본 이미지를 그림.
3.  **색상 처리 로직 개선**:
    *   초기 중심점 선택 방식을 랜덤에서 거리를 고려한 K-means++ 방식으로 변경하여 눈에 띄는 색상이 중심점으로 선택될 확률을 높임.
4.  **도안 및 색상표 렌더링**: 기존 로직 유지 및 적용.